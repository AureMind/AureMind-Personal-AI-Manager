{% extends "notes/base.html" %}
{% load static %}
{% load file_filters %}

{% block title %}Files{% endblock %}

{% block content %}
<h1>Your Files</h1>

{% if notes_with_files %}
  <ul class="list-group">
    {% for note in notes_with_files %}
      <li class="list-group-item">
        <strong>Note:</strong> <a href="{% url 'notes:detail' pk=note.pk %}">{{ note.title }}</a><br>
        <strong>Uploaded File:</strong>
        {% if note.attachment %}
          {% with note.attachment.url as file_url %}
            {% if file_url|lower|endswith:".jpg" or file_url|lower|endswith:".jpeg" or file_url|lower|endswith:".png" or file_url|lower|endswith:".gif" %}
              <img src="{{ file_url }}" alt="Attachment" class="img-fluid" style="max-width: 300px;">
            {% elif file_url|lower|endswith:".pdf" %}
              <a href="{{ file_url }}" target="_blank">View PDF</a>
            {% elif file_url|lower|endswith:".mp4" or file_url|lower|endswith:".webm" %}
              <video controls style="max-width: 300px;">
                <source src="{{ file_url }}">
                Your browser does not support the video tag.
              </video>
            {% else %}
              <a href="{{ file_url }}" target="_blank">Download File</a>
            {% endif %}
          {% endwith %}
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>No files uploaded yet.</p>
{% endif %}
{% endblock %}
